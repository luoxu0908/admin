<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>杨凌之家</title>
    <meta name="description" content="杨凌之家|杨凌|房产">
    <meta name="keywords" content="index">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link rel="icon" type="image/png" href="assets/i/favicon.png">
    <link rel="apple-touch-icon-precomposed" href="assets/i/app-icon72x72@2x.png">
    <meta name="apple-mobile-web-app-title" content="Amaze UI" />
    <!-- <script src="assets/js/echarts.min.js"></script> -->
    <link rel="stylesheet" href="assets/css/amazeui.min.css" />
    <link rel="stylesheet" href="assets/css/amazeui.datatables.min.css" />
    <link rel="stylesheet" href="assets/css/app.css">
    <script src="assets/js/jquery.min.js"></script>
    <script src="scripts/Master.js"></script>
    <script src="scripts/Security.js"></script>
</head>

<body data-type="index">
    <script src="assets/js/theme.js"></script>
    <div class="am-g tpl-g">
        <!-- 头部 -->
        <header>
            <!-- logo -->
            <div class="am-fl tpl-header-logo">
                <a href="index.html"><img src="assets/img/logo.png" alt=""></a>
            </div>
            <!-- 右侧内容 -->
            <div class="tpl-header-fluid">
                <!-- 侧边切换 -->
                <div class="am-fl tpl-header-switch-button am-icon-list">
                    <span>
                    </span>
                </div>
                <!-- 搜索 -->
                <div class="am-fl tpl-header-search">
                    <form class="tpl-header-search-form" action="javascript:;">
                        <button class="tpl-header-search-btn am-icon-search"></button>
                        <input class="tpl-header-search-box" type="text" placeholder="搜索内容...">
                    </form>
                </div>
                <!-- 其它功能-->
                <div class="am-fr tpl-header-navbar">
                    <ul>
                        <!-- 欢迎语 -->
                        <li class="am-text-sm tpl-header-navbar-welcome">
                            <a href="javascript:;">欢迎您, <span id="dispname"></span> </a>
                        </li>
                        <!-- 新邮件 -->
                        <li class="am-dropdown tpl-dropdown" data-am-dropdown>
                            <a href="javascript:;" class="am-dropdown-toggle tpl-dropdown-toggle"
                                data-am-dropdown-toggle>
                                <i class="am-icon-envelope"></i>
                                <span class="am-badge am-badge-success am-round item-feed-badge">4</span>
                            </a>
                            <!-- 弹出列表 -->
                            <ul class="am-dropdown-content tpl-dropdown-content">
                                <li class="tpl-dropdown-menu-messages">
                                    <a href="javascript:;" class="tpl-dropdown-menu-messages-item am-cf">
                                        <div class="menu-messages-ico">
                                            <img src="assets/img/user04.png" alt="">
                                        </div>
                                        <div class="menu-messages-time">
                                            3小时前
                                        </div>
                                        <div class="menu-messages-content">
                                            <div class="menu-messages-content-title">
                                                <i class="am-icon-circle-o am-text-success"></i>
                                                <span>夕风色</span>
                                            </div>
                                            <div class="am-text-truncate"> Amaze UI 的诞生，依托于 GitHub
                                                及其他技术社区上一些优秀的资源；Amaze UI 的成长，则离不开用户的支持。 </div>
                                            <div class="menu-messages-content-time">2016-09-21 下午 16:40</div>
                                        </div>
                                    </a>
                                </li>
                                <li class="tpl-dropdown-menu-messages">
                                    <a href="javascript:;" class="tpl-dropdown-menu-messages-item am-cf">
                                        <div class="menu-messages-ico">
                                            <img src="assets/img/user02.png" alt="">
                                        </div>
                                        <div class="menu-messages-time">
                                            5天前
                                        </div>
                                        <div class="menu-messages-content">
                                            <div class="menu-messages-content-title">
                                                <i class="am-icon-circle-o am-text-warning"></i>
                                                <!-- <span id="UserName"></span> -->
                                            </div>
                                            <div class="am-text-truncate"> 为了能最准确的传达所描述的问题， 建议你在反馈时附上演示，方便我们理解。 </div>
                                            <div class="menu-messages-content-time">2016-09-16 上午 09:23</div>
                                        </div>
                                    </a>
                                </li>
                                <li class="tpl-dropdown-menu-messages">
                                    <a href="javascript:;" class="tpl-dropdown-menu-messages-item am-cf">
                                        <i class="am-icon-circle-o"></i> 进入列表…
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <!-- 新提示 -->
                        <li class="am-dropdown" data-am-dropdown>
                            <a href="javascript:;" class="am-dropdown-toggle" data-am-dropdown-toggle>
                                <i class="am-icon-bell"></i>
                                <span class="am-badge am-badge-warning am-round item-feed-badge">5</span>
                            </a>
                            <!-- 弹出列表 -->
                            <ul class="am-dropdown-content tpl-dropdown-content">
                                <li class="tpl-dropdown-menu-notifications">
                                    <a href="javascript:;" class="tpl-dropdown-menu-notifications-item am-cf">
                                        <div class="tpl-dropdown-menu-notifications-title">
                                            <i class="am-icon-line-chart"></i>
                                            <span> 有6笔新的销售订单</span>
                                        </div>
                                        <div class="tpl-dropdown-menu-notifications-time">
                                            12分钟前
                                        </div>
                                    </a>
                                </li>
                                <li class="tpl-dropdown-menu-notifications">
                                    <a href="javascript:;" class="tpl-dropdown-menu-notifications-item am-cf">
                                        <div class="tpl-dropdown-menu-notifications-title">
                                            <i class="am-icon-star"></i>
                                            <span> 有3个来自人事部的消息</span>
                                        </div>
                                        <div class="tpl-dropdown-menu-notifications-time">
                                            30分钟前
                                        </div>
                                    </a>
                                </li>
                                <li class="tpl-dropdown-menu-notifications">
                                    <a href="javascript:;" class="tpl-dropdown-menu-notifications-item am-cf">
                                        <div class="tpl-dropdown-menu-notifications-title">
                                            <i class="am-icon-folder-o"></i>
                                            <span> 上午开会记录存档</span>
                                        </div>
                                        <div class="tpl-dropdown-menu-notifications-time">
                                            1天前
                                        </div>
                                    </a>
                                </li>
                                <li class="tpl-dropdown-menu-notifications">
                                    <a href="javascript:;" class="tpl-dropdown-menu-notifications-item am-cf">
                                        <i class="am-icon-bell"></i> 进入列表…
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <!-- 退出 -->
                        <li class="am-text-sm" class=“logout”>
                            <a href="javascript:;" onclick="Logout();return false;">
                                <span class="am-icon-sign-out"></span> 退出
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </header>
        <!-- 风格切换 -->
        <!-- 侧边导航栏 -->
        <div class="left-sidebar">
            <!-- 用户信息 -->
            <div class="tpl-sidebar-user-panel">
                <div class="tpl-user-panel-slide-toggleable">
                    <div class="tpl-user-panel-profile-picture">
                        <img src="assets/img/user04.png" alt="">
                    </div>
                    <span class="user-panel-logged-in-text">
                        <i class="am-icon-circle-o am-text-success tpl-user-panel-status-icon"></i>
                        <span id="UserName">xxxxx</span>
                    </span>
                    <a href="javascript:;" class="tpl-user-panel-action-link"> <span class="am-icon-pencil"></span>
                        账号设置</a>
                </div>
            </div>
            <!-- 菜单 -->
            <ul class="sidebar-nav">
                <li class="sidebar-nav-heading">菜单 <span class="sidebar-nav-heading-info"> </span></li>
                <div id="menuContent"></div>
            </ul>
        </div>
        <!-- 内容区域 -->
        <div class="tpl-content-wrapper">
            <div class="container-fluid am-cf" style="display:none;">
                <div class="row">
                    <div class="am-u-sm-12 am-u-md-12 am-u-lg-9">
                        <div class="page-header-heading"><span class="am-icon-home page-header-heading-icon"></span>
                            部件首页 <small>Amaze UI</small></div>
                        <p class="page-header-description">Amaze UI 含近 20 个 CSS 组件、20 余 JS 组件，更有多个包含不同主题的 Web 组件。</p>
                    </div>
                    <div class="am-u-lg-3 tpl-index-settings-button">
                        <button type="button" class="page-header-button"><span class="am-icon-paint-brush"></span> 设置</button>
                    </div>
                </div>
            </div>
            <div class="widget-body  am-fr" style="background:#e9ecf3">
                <iframe id="contentframe" src="about:blank" frameborder="0" style="border-radius:10px;"></iframe>
                <div id="ifrCDiv" style="display:none; overflow:auto; overflow-x:auto; overflow-y:auto; -webkit-overflow-scrolling:touch;border-radius:10px;">
                </div>
            </div>
        </div>
    </div>
    <style>
        .tpl-content-wrapper {
            min-height: 730px;
        }
    </style>
    <script src="assets/js/amazeui.min.js"></script>
    <script src="assets/js/amazeui.datatables.min.js"></script>
    <script src="assets/js/dataTables.responsive.min.js"></script>
    <script src="assets/js/app.js"></script>
    <script>
        window.ifrC = $('#contentframe');
        window.ifrCDiv = $('#ifrCDiv'); //iOS compatability hack
        GetMenu();
        $(function () {
            CookieIsActive();
            LoginInfo().done(function (data) {
                if (data.d.RetData.LoginID <= 0) {
                    window.top.location = 'login.htm';
                } else {
                    $('#dispname').html(data.d.RetData.DispName);
                    $('#UserName').html(data.d.RetData.Username);
                    if ($.cookie('Menu') !== null && parseInt($.cookie('Menu')) === 0) { } else { $('nav').removeClass('bchide'); GetMenu(); }
                    if ($.cookie('CurrPage') !== null) {
                        ChangeFrameSrc($.cookie('CurrPage'));
                    } else {
                        ChangeFrameSrc('landing.htm');
                    }
                }
            });

        });
        function GetMenu(callback) {
            $.JSONPost('iCtc1.GetOwnPersonID.json')
                .done(function (data) {
                    var R = data.d.RetData.Tbl.Rows, RowCnt = R.length;
                    if (RowCnt > 0) { window.PID = R[0].PersonID; }
                    loadMenu();
                });
        }
        function BindEvent() {
            $('.sidebar-nav-sub-title').on('click', function () {
                $(this).siblings('.sidebar-nav-sub').slideToggle(80)
                    .end()
                    .find('.sidebar-nav-sub-ico').toggleClass('sidebar-nav-sub-ico-rotate');
            });
        }
        function loadMenu() {
            $.JSONPost('Sec1.Menu.json', { '': '' })
                .done(function (data) {
                    var R = data.d.RetData.Tbl.Rows, RowCnt = R.length;
                    if (RowCnt > 0) {
                        if ((data) && (data.d.RetData.Tbl.Rows.length > 0)) {
                            var menus = data.d.RetData.Tbl.Rows;
                            var menuList = new Array();

                            for (var i = 0; i < menus.length; i++) {
                                var menuItem = {};
                                var manuName = menus[i].MenuName.split('\\')[0];
                                var subName = menus[i].MenuName.split('\\')[1];
                                var subItem = {};
                                var flag = false;
                                for (var j = 0; j < menuList.length; j++) {
                                    if (menuList[j].Name.indexOf(manuName) > -1) {
                                        subItem.Name = subName;
                                        subItem.Value = menus[i].RelativeURL;
                                        menuList[j].URLList.push(subItem);
                                        flag = true;
                                    }
                                }
                                if (!flag) {
                                    menuItem.Name = manuName;
                                    menuItem.URLList = new Array();
                                    subItem.Name = subName;
                                    subItem.Value = menus[i].RelativeURL;
                                    menuItem.URLList.push(subItem);
                                    menuList.push(menuItem);
                                }
                            }
                            var menuHtml = '';
                            var defaultPageUrl=''
                            var arry = new Array('home', 'search', 'wpforms', 'user', 'phone', 'ship', 'simplybuilt', 'server', 'search', 'table', 'phone', 'search', 'table', 'phone', 'search', 'table', 'phone', 'search')
                            for (var i = 0; i < menuList.length; i++) {
                                menuHtml += '<li class="sidebar-nav-link">';
                                //am-icon-table 
                                menuHtml += '<a href="javascript:;" class="sidebar-nav-sub-title"><i class="am-icon-' + arry[i] + ' sidebar-nav-link-logo"></i> ' + menuList[i].Name + '<span class="am-icon-chevron-down am-fr am-margin-right-sm sidebar-nav-sub-ico"></span></a>';
                                menuHtml += '<ul class="sidebar-nav sidebar-nav-sub">';
                                for (var j = 0; j < menuList[i].URLList.length; j++) {
                                   if(menuList[i].URLList[j].Name == "个人资料"){
                                    defaultPageUrl=menuList[i].URLList[j].Value + '&PID=' + window.PID;
                                   }
                                    if (menuList[i].URLList[j].Name == "架构中心" || menuList[i].URLList[j].Name == "我的收藏") {
                                        menuHtml += '<li class="sidebar-nav-link"><i class="fa fa-phone"></i><a target="_top" onclick="ChangeFrameSrc(\'' + menuList[i].URLList[j].Value + '?PID=' + window.PID + '\');return false;" href="javascript:;" "> <span class="am-icon-angle-right sidebar-nav-link-logo"></span> ' + (menuList[i].URLList[j].Name || menuList[i].Name) + '</a></li>';
                                    } else {
                                        menuHtml += '<li class="sidebar-nav-link"><i class="fa fa-phone"></i><a target="_top" onclick="ChangeFrameSrc(\'' + menuList[i].URLList[j].Value + '&PID=' + window.PID + '\');return false;" href="javascript:;" "> <span class="am-icon-angle-right sidebar-nav-link-logo"></span> ' + (menuList[i].URLList[j].Name || menuList[i].Name) + '</a></li>';
                                    }
                                }
                                menuHtml += '</ul>';
                                menuHtml += '</li>';
                            }

                            $('#menuContent').html(menuHtml); BindEvent();
                            ChangeFrameSrc(defaultPageUrl);
                        }
                    }
                });
        }

        function ResizeMainC() {
            var newheight = 0, vpHeight = 0;
            if ($.cookie('CurrPage') !== null) {
                vpHeight = $(window).height() - $('nav').height();
            } else {
                vpHeight = $(window).height();
            }
            // var CssVal = { 'height': vpHeight + 'px', 'width': $(window).width() + 'px' };
            var CssVal = { 'height': vpHeight - $('header').height() - 20 + 'px', 'width': 100 + '%' };
            window.ifrC.css(CssVal);
        }
        window.ChangeFrameSrc = function (url, isSubMenu) {
            $('#overlay').removeClass('bchide');
            isSubMenu = (isSubMenu) ? isSubMenu : false;
            if ($.cookie('CurrPage') === null) {
                // this is to check that only when redirect from login page, then get the menu.
                $('nav').removeClass('bchide');
            }
            var $profile = $('#profilediv');
            if (!($profile.hasClass('bchide'))) {
                $profile.addClass('bchide'); $('.profilem').removeClass('selected');
            }
            if ($('.more.selected').length > 0) { // if more is selected, then hide the submenu
                var $submenudiv = $('#menudiv'), $more = $('.more');
                $submenudiv.addClass('bchide').parent().parent().addClass('bchide').removeClass('submenuborder');
                $more.removeClass('selected');
                $submenudiv.css({ height: 'auto' });
            }
            vpHeight = $(window).height() - $('nav').height();
            $('#overlay').css({ 'height': vpHeight + 'px' }); $('#overlay_content').css({ 'margin-top': (vpHeight / 2) + 'px' });
            $.cookie('CurrPage', url);
            ResizeMainC();
            $('#contentframe').attr('src', url);
            $('#contentframe').load(function () {
                $('#overlay').addClass('bchide');
            });
        }

        function Logout() {
            return $.JSONPost('Sec1.Logout.json', {})
                .then(function (data) {
                    $.cookie('CurrPage', null, { 'expires': 1 });
                    //window.top.location = (data.d.RetData || 'index.html');
                    window.top.location = ('login.html');
                });
        }
    </script>
</body>

</html>
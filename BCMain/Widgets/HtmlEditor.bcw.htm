<div class="large-12 columns">
	<div class="row">
		<div class="large-3 columns end">
			<label for="Subject">
				Subject
			</label>
			<input id="Subject" type="text" />
		</div>
	</div>
	<div class="row">
		<div class="large-12 columns">
			<textarea name="editorhtml" id="editorhtml" rows="10"></textarea>
		</div>
	</div>
	<div class="row">
		<div class="large-12 columns">
			<br />
			<button class="right" id="Save" onclick="Save(); return false;">
				Save
			</button>
		</div>
	</div>
</div>
<script src="../../ckeditor/ckeditor.js"></script>
<script type="text/javascript">
	CKEDITOR.replace('editorhtml');
	window.QS = $.parseQS();
	var GetJson = window.QS.Get;
	var SaveJson = window.QS.Save;
	$(document).ready(function () {
		if ((typeof (window.QS.RefData) != "undefined" && window.QS.RefData.length > 0 && window.QS.RefData != '')) {
			GetMessage();
		}
	});
	function GetMessage() {
		return $.JSONPost(GetJson, { 'RefData': window.QS.RefData, 'RefData1': '', 'RefData2': '' })
				.done(function (data) {
					var R = data.d.RetData.Tbl.Rows, RowCnt = R.length;
					if (RowCnt > 0) {
						$('#editorhtml').val(R[0]["Message"]);
						$('#Subject').val(R[0]["Subject"]);
					}
				});
	}
	function Save() {
		return $.JSONPost(SaveJson, { 'Content': $('#editorhtml').val(), 'RefData': window.QS.RefData, 'RefData1': $('#Subject').val(), 'RefData2': '' })
				.done(function (data) {
					if ((data) && (data.d.RetVal === -1)) {
						//if (data.d.RetData.Tbl.Rows[0].Success == true) {
						$.alert('Successfully Updated/Saved', { theme: 'growlsuccess', sticky: false });
					}
					else { $('#msgbox').dialog({ 'title': 'Update Failed' }).html('<p><span class="ui-icon ui-icon-alert" style="float: left; margin: 5px 7px 50px 0;"></span>' + data.d.RetMsg + '</p>').dialog('open'); }

				});
	}
</script>
